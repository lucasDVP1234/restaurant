<!-- views/applicants.ejs -->
<!DOCTYPE html>
<html lang="fr">
<head>
  <title>Candidats pour <%= job.description %></title>
  <!-- Include Montserrat Font and Tailwind CSS -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/tailwind.css">
</head>
<body class="bg-gray-50 min-h-screen">
  <!-- Header -->
  <%- include('header-login') %>

  <!-- Main Container -->
  <div class="container mx-auto px-4 py-12">
    <h1 class="text-3xl font-bold mb-4">Candidats pour le job : <%= job.description %></h1>

    <% if (applicants.length > 0) { %>
      <table class="min-w-full bg-white rounded-2xl shadow-md">
        <thead>
          <tr>
            <th class="px-6 py-4 border-b text-left text-sm font-medium text-gray-500 uppercase">Nom</th>
            <th class="px-6 py-4 border-b text-left text-sm font-medium text-gray-500 uppercase">Email</th>
            <th class="px-6 py-4 border-b text-left text-sm font-medium text-gray-500 uppercase">Statut</th>
            <th class="px-6 py-4 border-b text-left text-sm font-medium text-gray-500 uppercase">Action</th>
          </tr>
        </thead>
        <tbody>
          <% applicants.forEach(function(applicant) { %>
            <tr class="hover:bg-gray-50">
              <td class="px-6 py-4 border-b text-sm text-gray-700"><%= applicant.firstName %> <%= applicant.lastName %></td>
              <td class="px-6 py-4 border-b text-sm text-gray-700"><%= applicant.email %></td>
              <td class="px-6 py-4 border-b text-sm text-gray-700">
                <% if (job.selectedApplicant && job.selectedApplicant._id.toString() === applicant._id.toString()) { %>
                  Sélectionné
                <% } else { %>
                  En attente
                <% } %>
              </td>
              <td class="px-6 py-4 border-b text-sm text-gray-700">
                <% if (!job.selectedApplicant) { %>
                  <form action="/select-applicant/<%= job._id %>/<%= applicant._id %>" method="POST">
                    <button type="submit" class="bg-green-500 text-white px-4 py-2 rounded">Choisir</button>
                  </form>
                <% } else if (job.selectedApplicant._id.toString() === applicant._id.toString()) { %>
                  <!-- Optionally allow to deselect or take other actions -->
                <% } else { %>
                  <!-- Do nothing or show message -->
                <% } %>
              </td>
            </tr>
          <% }); %>
        </tbody>
      </table>
    <% } else { %>
      <p>Aucun candidat pour ce job.</p>
    <% } %>
  </div>
</body>
</html>
